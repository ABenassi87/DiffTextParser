!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("DiffParser",[],t):"object"==typeof exports?exports.DiffParser=t():e.DiffParser=t()}(window,function(){return r={},i.m=n=[function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return r});var P=-1,g=/[^a-zA-Z0-9]/,c=/\s/,b=/[\r\n]/,v=/\n\r?\n$/,p=/^\r?\n\r?\n/;function d(e,t){if(!e||!t||e.charAt(0)!=t.charAt(0))return 0;for(var n=0,r=Math.min(e.length,t.length),i=r,a=0;n<i;)e.substring(a,i)==t.substring(a,i)?a=n=i:r=i,i=Math.floor((r-n)/2+n);return i}function m(e,t){if(!e||!t||e.charAt(e.length-1)!=t.charAt(t.length-1))return 0;for(var n=0,r=Math.min(e.length,t.length),i=r,a=0;n<i;)e.substring(e.length-i,e.length-a)==t.substring(t.length-i,t.length-a)?a=n=i:r=i,i=Math.floor((r-n)/2+n);return i}function o(e,t,n){for(var r,i,a,s,l=e.substring(n,n+Math.floor(e.length/4)),u=-1,h="";-1!=(u=t.indexOf(l,u+1));){var f=d(e.substring(n),t.substring(u)),o=m(e.substring(0,n),t.substring(0,u));h.length<o+f&&(h=t.substring(u-o,u)+t.substring(u,u+f),r=e.substring(0,n-o),i=e.substring(n+f),a=t.substring(0,u-o),s=t.substring(u+f))}return 2*h.length>=e.length?[r,i,a,s,h]:null}function a(e,t,n,r){for(var i="",a=0,s=-1,l=t.length;s<e.length-1;){-1==(s=e.indexOf("\n",a))&&(s=e.length-1);var u=e.substring(a,s+1);(n.hasOwnProperty?n.hasOwnProperty(u):void 0!==n[u])?i+=String.fromCharCode(n[u]):(l==r&&(u=e.substring(a),s=e.length),i+=String.fromCharCode(l),n[u]=l,t[l++]=u),a=s+1}return i}function y(e,t){if(!e||!t)return 6;var n=e.charAt(e.length-1),r=t.charAt(0),i=n.match(g),a=r.match(g),s=i&&n.match(c),l=a&&r.match(c),u=s&&n.match(b),h=l&&r.match(b),f=u&&e.match(v),o=h&&t.match(p);return f||o?5:u||h?4:i&&!s&&l?3:s||l?2:i||a?1:0}function M(e,t){var n=e.length,r=t.length;if(0==n||0==r)return 0;r<n?e=e.substring(n-r):n<r&&(t=t.substring(0,n));var i=Math.min(n,r);if(e==t)return i;for(var a=0,s=1;;){var l=e.substring(i-s),u=t.indexOf(l);if(-1==u)return a;s+=u,0!=u&&e.substring(i-s)!=t.substring(0,s)||(a=s,s++)}}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),s(this,"diffTimeout",1),s(this,"diffEditCost",4),s(this,"matchThreshold",.5),s(this,"matchDistance",1e3),s(this,"patchDeleteThreshold",.5),s(this,"patchMargin",4),s(this,"matchMaxBits",32)}var t,n,r;return t=e,(n=[{key:"diffMain",value:function(e,t,n,r){void 0===r&&(r=this.diffTimeout<=0?Number.MAX_VALUE:(new Date).getTime()+1e3*this.diffTimeout);var i=r;if(null==e||null==t)throw new Error("Null input. (diff_main)");if(e==t)return e?[[0,e]]:[];void 0===n&&(n=!0);var a=n,s=d(e,t),l=e.substring(0,s);s=m(e=e.substring(s),t=t.substring(s));var u=e.substring(e.length-s);e=e.substring(0,e.length-s),t=t.substring(0,t.length-s);var h=this.compute(e,t,a,i);return l&&h.unshift([0,l]),u&&h.push([0,u]),this.cleanupMerge(h),h}},{key:"compute",value:function(e,t,n,r){var i=[];if(!e)return[[1,t]];if(!t)return[[P,e]];var a=e.length>t.length?e:t,s=e.length>t.length?t:e,l=a.indexOf(s);if(-1!=l)return i=[[1,a.substring(0,l)],[0,s],[1,a.substring(l+s.length)]],e.length>t.length&&(i[0][0]=i[2][0]=P),i;if(1==s.length)return[[P,e],[1,t]];var u=this.halfMatch(e,t);if(u){var h=u[0],f=u[1],o=u[2],g=u[3],c=u[4],b=this.diffMain(h,o,n,r),v=this.diffMain(f,g,n,r);return b.concat([[0,c]],v)}return n&&100<e.length&&100<t.length?this.lineMode(e,t,r):this.bisect(e,t,r)}},{key:"halfMatch",value:function(e,t){if(this.diffTimeout<=0)return null;var n=e.length>t.length?e:t,r=e.length>t.length?t:e;if(n.length<4||2*r.length<n.length)return null;var i,a,s,l,u,h=o(n,r,Math.ceil(n.length/4)),f=o(n,r,Math.ceil(n.length/2));return h||f?(i=!f||h&&h[4].length>f[4].length?h:f,e.length>t.length?(a=i[0],s=i[1],l=i[2],u=i[3]):(l=i[0],u=i[1],a=i[2],s=i[3]),[a,s,l,u,i[4]]):null}},{key:"lineMode",value:function(e,t,n){var r=this.linesToChars(e,t);e=r.chars1,t=r.chars2;var i=r.lineArray,a=this.diffMain(e,t,!1,n);this.charsToLines(a,i),this.cleanupSemantic(a),a.push([0,""]);for(var s=0,l=0,u=0,h="",f="";s<a.length;){switch(a[s][0]){case 1:u++,f+=a[s][1];break;case P:l++,h+=a[s][1];break;case 0:if(1<=l&&1<=u){a.splice(s-l-u,l+u),s=s-l-u;for(var o=this.diffMain(h,f,!1,n),g=o.length-1;0<=g;g--)a.splice(s,0,o[g]);s+=o.length}l=u=0,f=h=""}s++}return a.pop(),a}},{key:"cleanupSemantic",value:function(e){for(var t=!1,n=[],r=0,i=null,a=0,s=0,l=0,u=0,h=0;a<e.length;)0==e[a][0]?(s=u,l=h,h=u=0,i=e[n[r++]=a][1]):(1==e[a][0]?u+=e[a][1].length:h+=e[a][1].length,i&&i.length<=Math.max(s,l)&&i.length<=Math.max(u,h)&&(e.splice(n[r-1],0,[P,i]),e[n[r-1]+1][0]=1,r--,a=0<--r?n[r-1]:-1,h=u=l=s=0,t=!(i=null))),a++;for(t&&this.cleanupMerge(e),this.cleanupSemanticLossless(e),a=1;a<e.length;){if(e[a-1][0]==P&&1==e[a][0]){var f=e[a-1][1],o=e[a][1],g=M(f,o),c=M(o,f);c<=g?(g>=f.length/2||g>=o.length/2)&&(e.splice(a,0,[0,o.substring(0,g)]),e[a-1][1]=f.substring(0,f.length-g),e[a+1][1]=o.substring(g),a++):(c>=f.length/2||c>=o.length/2)&&(e.splice(a,0,[0,f.substring(0,c)]),e[a-1][0]=1,e[a-1][1]=o.substring(0,o.length-c),e[a+1][0]=P,e[a+1][1]=f.substring(c),a++),a++}a++}}},{key:"cleanupMerge",value:function(e){e.push([0,""]);for(var t,n=0,r=0,i=0,a="",s="";n<e.length;)switch(e[n][0]){case 1:i++,s+=e[n][1],n++;break;case P:r++,a+=e[n][1],n++;break;case 0:1<r+i?(0!==r&&0!==i&&(0!==(t=d(s,a))&&(0<n-r-i&&0==e[n-r-i-1][0]?e[n-r-i-1][1]+=s.substring(0,t):(e.splice(0,0,[0,s.substring(0,t)]),n++),s=s.substring(t),a=a.substring(t)),0!==(t=m(s,a))&&(e[n][1]=s.substring(s.length-t)+e[n][1],s=s.substring(0,s.length-t),a=a.substring(0,a.length-t))),n-=r+i,e.splice(n,r+i),a.length&&(e.splice(n,0,[P,a]),n++),s.length&&(e.splice(n,0,[1,s]),n++),n++):0!==n&&0==e[n-1][0]?(e[n-1][1]+=e[n][1],e.splice(n,1)):n++,r=i=0,s=a=""}""===e[e.length-1][1]&&e.pop();var l=!1;for(n=1;n<e.length-1;)0==e[n-1][0]&&0==e[n+1][0]&&(e[n][1].substring(e[n][1].length-e[n-1][1].length)==e[n-1][1]?(e[n][1]=e[n-1][1]+e[n][1].substring(0,e[n][1].length-e[n-1][1].length),e[n+1][1]=e[n-1][1]+e[n+1][1],e.splice(n-1,1),l=!0):e[n][1].substring(0,e[n+1][1].length)==e[n+1][1]&&(e[n-1][1]+=e[n+1][1],e[n][1]=e[n][1].substring(e[n+1][1].length)+e[n+1][1],e.splice(n+1,1),l=!0)),n++;l&&this.cleanupMerge(e)}},{key:"cleanupSemanticLossless",value:function(e){for(var t=1;t<e.length-1;){if(0==e[t-1][0]&&0==e[t+1][0]){var n=e[t-1][1],r=e[t][1],i=e[t+1][1],a=m(n,r);if(a){var s=r.substring(r.length-a);n=n.substring(0,n.length-a),r=s+r.substring(0,r.length-a),i=s+i}for(var l=n,u=r,h=i,f=y(n,r)+y(r,i);r.charAt(0)===i.charAt(0);){n+=r.charAt(0),r=r.substring(1)+i.charAt(0),i=i.substring(1);var o=y(n,r)+y(r,i);f<=o&&(f=o,l=n,u=r,h=i)}e[t-1][1]!=l&&(l?e[t-1][1]=l:(e.splice(t-1,1),t--),e[t][1]=u,h?e[t+1][1]=h:(e.splice(t+1,1),t--))}t++}}},{key:"cleanupEfficiency",value:function(e){for(var t=!1,n=[],r=0,i=null,a=0,s=!1,l=!1,u=!1,h=!1;a<e.length;)0==e[a][0]?(i=e[a][1].length<this.diffEditCost&&(u||h)?(s=u,l=h,e[n[r++]=a][1]):(r=0,null),u=h=!1):(e[a][0]==P?h=!0:u=!0,i&&(s&&l&&u&&h||i.length<this.diffEditCost/2&&+s+ +l+ +u+ +h==3)&&(e.splice(n[r-1],0,[P,i]),e[n[r-1]+1][0]=1,r--,i=null,s&&l?(u=h=!0,r=0):(a=0<--r?n[r-1]:-1,u=h=!1),t=!0)),a++;t&&this.cleanupMerge(e)}},{key:"bisect",value:function(e,t,n){for(var r=e.length,i=t.length,a=Math.ceil((r+i)/2),s=a,l=2*a,u=new Array(l),h=new Array(l),f=0;f<l;f++)u[f]=-1,h[f]=-1;u[s+1]=0;for(var o=r-i,g=o%2!=(h[s+1]=0),c=0,b=0,v=0,p=0,d=0;d<a&&!((new Date).getTime()>n);d++){for(var m=-d+c;m<=d-b;m+=2){for(var y=s+m,M=void 0,k=(M=m==-d||m!=d&&u[y-1]<u[y+1]?u[y+1]:u[y-1]+1)-m;M<r&&k<i&&e.charAt(M)==t.charAt(k);)M++,k++;if(r<(u[y]=M))b+=2;else if(i<k)c+=2;else if(g){var w=s+o-m;if(0<=w&&w<l&&-1!=h[w])if(r-h[w]<=M)return this.bisectSplit(e,t,M,k,n)}}for(var A=-d+v;A<=d-p;A+=2){for(var x=s+A,j=void 0,O=(j=A==-d||A!=d&&h[x-1]<h[x+1]?h[x+1]:h[x-1]+1)-A;j<r&&O<i&&e.charAt(r-j-1)==t.charAt(i-O-1);)j++,O++;if(r<(h[x]=j))p+=2;else if(i<O)v+=2;else if(!g){var T=s+o-A;if(0<=T&&T<l&&-1!=u[T]){var S=u[T],D=s+S-T;if((j=r-j)<=S)return this.bisectSplit(e,t,S,D,n)}}}}return[[P,e],[1,t]]}},{key:"bisectSplit",value:function(e,t,n,r,i){var a=e.substring(0,n),s=t.substring(0,r),l=e.substring(n),u=t.substring(r),h=this.diffMain(a,s,!1,i),f=this.diffMain(l,u,!1,i);return h.concat(f)}},{key:"xIndex",value:function(e,t){var n,r=0,i=0,a=0,s=0;for(n=0;n<e.length&&(1!==e[n][0]&&(r+=e[n][1].length),e[n][0]!==P&&(i+=e[n][1].length),!(t<r));n++)a=r,s=i;return e.length!=n&&e[n][0]===P?s:s+(t-a)}},{key:"prettyHtml",value:function(e){for(var t=[],n=/&/g,r=/</g,i=/>/g,a=/\n/g,s=0;s<e.length;s++){var l=e[s][0],u=e[s][1].replace(n,"&amp;").replace(r,"&lt;").replace(i,"&gt;").replace(a,"&para;<br>");switch(l){case 1:t[s]='<ins style="background:#e6ffe6;">'+u+"</ins>";break;case P:t[s]='<del style="background:#ffe6e6;">'+u+"</del>";break;case 0:t[s]="<span>"+u+"</span>"}}return t.join("")}},{key:"text1",value:function(e){for(var t=[],n=0;n<e.length;n++)1!==e[n][0]&&(t[n]=e[n][1]);return t.join("")}},{key:"text2",value:function(e){for(var t=[],n=0;n<e.length;n++)e[n][0]!==P&&(t[n]=e[n][1]);return t.join("")}},{key:"levenshtein",value:function(e){for(var t=0,n=0,r=0,i=0;i<e.length;i++){var a=e[i][0],s=e[i][1];switch(a){case 1:n+=s.length;break;case P:r+=s.length;break;case 0:t+=Math.max(n,r),r=n=0}}return t+=Math.max(n,r),t}},{key:"toDelta",value:function(e){for(var t=[],n=0;n<e.length;n++)switch(e[n][0]){case 1:t[n]="+"+encodeURI(e[n][1]);break;case P:t[n]="-"+e[n][1].length;break;case 0:t[n]="="+e[n][1].length}return t.join("\t").replace(/%20/g," ")}},{key:"fromDelta",value:function(e,t){for(var n=[],r=0,i=0,a=t.split(/\t/g),s=0;s<a.length;s++){var l=a[s].substring(1);switch(a[s].charAt(0)){case"+":try{n[r++]=[1,decodeURI(l)]}catch(e){throw new Error("Illegal escape in diff_fromDelta: "+l)}break;case"-":case"=":var u=parseInt(l,10);if(isNaN(u)||u<0)throw new Error("Invalid number in diff_fromDelta: "+l);var h=e.substring(i,i+=u);"="==a[s].charAt(0)?n[r++]=[0,h]:n[r++]=[P,h];break;default:if(a[s])throw new Error("Invalid diff operation in diff_fromDelta: "+a[s])}}if(i!=e.length)throw new Error("Delta length ("+i+") does not equal source text length ("+e.length+").");return n}},{key:"linesToChars",value:function(e,t){var n=[],r={};n[0]="";var i=4e4;return{chars1:a(e,n,r,i),chars2:a(t,n,r,i=65535),lineArray:n}}},{key:"charsToLines",value:function(e,t){for(var n=0;n<e.length;n++){for(var r=e[n][1],i=[],a=0;a<r.length;a++)i[a]=t[r.charCodeAt(a)];e[n][1]=i.join("")}}}])&&i(t.prototype,n),r&&i(t,r),e}()}],i.c=r,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0);function i(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,i),t.l=!0,t.exports}var n,r});